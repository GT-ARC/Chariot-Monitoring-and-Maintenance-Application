<div id="device-panel">

  <div id="device-panel-head"
        fxFlex="0 1 calc(100%)">
    <span>{{device.name}}</span>
    <button *ngIf="!issueState" class="issue-detected-button" routerLink="/maintenance/{{device.getIssueID()}}">
      Issue detected
      <mat-icon>launch</mat-icon>
    </button>
  </div>

  <div id="device-panel-wrapper"

       gdAlignColumns="start start"

       gdAreas="{{currentArea}}"
       gdColumns="{{currentColumns}}"

       gdAuto="row"
       gdGap="16px">

    <div gdArea="a0">
      <app-device-panel-switch
        *ngIf="!device.deviceGroup"
        (uploaded)="emitDeviceProperty($event.property, $event.state)"
        [device]="device"></app-device-panel-switch>
    </div>

    <div gdArea="a1">
      <app-device-panel-power
        *ngIf="!device.deviceGroup"
        [device]="device">
      </app-device-panel-power>
    </div>

    <div gdArea="a2">
      <app-device-panel-idle-time
        *ngIf="!device.deviceGroup"
        [device]="device">
      </app-device-panel-idle-time>
    </div>

    <div gdArea="a3">
      <app-device-panel-info
        [device]="device"
        gdArea="a3">
      </app-device-panel-info>
    </div>

    <div gdArea="a4">
      <app-device-panel-issue-history
        [device]="device">
      </app-device-panel-issue-history>
    </div>

    <div *ngFor="let property of arrayProperties; let c = index"
         gdArea="a{{c}}">
      <app-property-bundle
        (uploaded)="emitDeviceProperty($event.property, $event.state)"
        [property]="property">
      </app-property-bundle>
    </div>

    <div gdArea="a{{arrayProperties.length + 5}}">
      <mat-icon id="property-bundle-icon"
        (click)="property_open = !property_open"
        class="sort-arrow">{{property_open ? 'keyboard_arrow_down' : 'keyboard_arrow_right'}}</mat-icon>
      <div id="property-bundle-name">
        Properties
      </div>
    </div>

    <!--  Create the cards for the properties of the device  -->
    <div
      gdArea="a{{arrayProperties.length + 6}}"
      *ngIf="property_open"
      gdAlignColumns="start start"

      gdAreas="{{propertyArea}}"
      gdColumns="calc((1/6)% - 16px) calc((1/6)% - 16px) calc((1/6)% - 16px) calc((1/6)% - 16px) calc((1/6)% - 16px) calc((1/6)% - 16px)"

      gdAuto="row"
      gdGap="16px">

      <div [ngSwitch]="property.type"
           *ngFor="let property of normalProperties; let i = index"
           gdArea="a{{i}}">

        <app-device-panel-switch
          *ngSwitchCase="'boolean'"
          (uploaded)="emitDeviceProperty($event.property, $event.state)"
          [property]="property">
        </app-device-panel-switch>

        <app-device-panel-slider
          *ngSwitchCase="'number'"
          (uploaded)="emitDeviceProperty($event.property, $event.state)"
          [property]="property">
        </app-device-panel-slider>

        <app-device-panel-text-field
          *ngSwitchCase="'string'"
          (uploaded)="emitDeviceProperty($event.property, $event.state)"
          [property]="property">
        </app-device-panel-text-field>

      </div>
    </div>

    <app-device-panel-monitoring
      gdArea="a{{arrayProperties.length + 7}}"
      [device]="device">
    </app-device-panel-monitoring>

    <app-warehouse-map
      gdArea="a{{arrayProperties.length + 8}}">

    </app-warehouse-map>

  </div>
</div>
